<div class="dialog-container">
  <h2 mat-dialog-title class="text-xl font-bold text-gray-800 mb-4">
    {{ isEdit ? '✏️ Editar Zona' : '➕ Nueva Zona' }}
  </h2>

  <mat-dialog-content>
    <form [formGroup]="form" class="flex flex-col gap-4">
      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Nombre de la Zona</mat-label>
        <input matInput formControlName="nombre" placeholder="Ej: Terraza">
        <mat-error *ngIf="form.get('nombre')?.hasError('required')">
          El nombre es requerido
        </mat-error>
        <mat-error *ngIf="form.get('nombre')?.hasError('minlength')">
          Mínimo 3 caracteres
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Restaurante</mat-label>
        <mat-select formControlName="restauranteId">
          <mat-option *ngFor="let restaurant of restaurants" [value]="restaurant.id">
            {{ restaurant.nombre }}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="form.get('restauranteId')?.hasError('required')">
          Seleccione un restaurante
        </mat-error>
      </mat-form-field>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Horario de Disponibilidad</label>
        
        <div class="grid grid-cols-2 gap-4 mb-4">
          <mat-form-field appearance="outline" class="w-full">
            <mat-label>Desde (hora)</mat-label>
            <mat-select formControlName="horaDesde" (selectionChange)="onHorarioChange()">
              <mat-option *ngFor="let hora of horas" [value]="hora">
                {{ hora }}:00
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.get('horaDesde')?.hasError('required')">
              Seleccione hora de inicio
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="w-full">
            <mat-label>Hasta (hora)</mat-label>
            <mat-select formControlName="horaHasta" (selectionChange)="onHorarioChange()">
              <mat-option *ngFor="let hora of horasHasta" [value]="hora">
                {{ hora }}:00
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.get('horaHasta')?.hasError('required')">
              Seleccione hora de fin
            </mat-error>
          </mat-form-field>
        </div>

        <div *ngIf="generatedHorarios.length > 0" class="bg-gray-50 border border-gray-200 rounded-lg p-3">
          <p class="text-sm font-medium text-gray-700 mb-2">Horarios generados:</p>
          <div class="flex flex-wrap gap-2">
            <span *ngFor="let horario of generatedHorarios" 
                  class="px-3 py-1 bg-indigo-100 text-indigo-800 rounded-full text-sm">
              {{ horario }}
            </span>
          </div>
        </div>

        <p class="text-xs text-red-600 mt-2" *ngIf="form.get('horaDesde')?.value && form.get('horaHasta')?.value && generatedHorarios.length === 0">
          La hora de inicio debe ser menor que la hora de fin
        </p>
      </div>

      <mat-checkbox formControlName="activa" color="primary">
        Zona activa
      </mat-checkbox>
    </form>
  </mat-dialog-content>

  <mat-dialog-actions align="end" class="gap-2">
    <button mat-button (click)="onCancel()" class="text-gray-600">
      Cancelar
    </button>
    <button
      mat-raised-button
      class="btn-primary"
      (click)="onSubmit()"
      [disabled]="!form.valid || generatedHorarios.length === 0"
    >
      {{ isEdit ? 'Actualizar' : 'Crear' }}
    </button>
  </mat-dialog-actions>
</div>
