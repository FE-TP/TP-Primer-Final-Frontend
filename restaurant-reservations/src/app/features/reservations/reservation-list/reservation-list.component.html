<div class="container mx-auto p-6 animate-fade-in">
  <div class="card">
    <!-- Header -->
    <div class="flex items-center gap-4 mb-8 pb-4 border-b-2 border-gray-100">
      <div class="icon-container bg-gradient-to-br from-orange-400 to-orange-600 !w-14 !h-14">
        <span class="text-3xl">ðŸ“…</span>
      </div>
      <div>
        <h2 class="text-3xl font-bold text-gray-800">Lista de Reservas</h2>
        <p class="text-sm text-gray-500 mt-1">GestiÃ³n de todas las reservas del sistema</p>
      </div>
    </div>

    <!-- Table -->
    <div class="overflow-x-auto rounded-xl" *ngIf="reservas.length > 0">
      <table mat-table [dataSource]="reservas" class="w-full">
        <!-- Fecha Column -->
        <ng-container matColumnDef="fecha">
          <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Fecha</th>
          <td mat-cell *matCellDef="let reserva" class="text-gray-800 font-medium">
            <div class="flex items-center gap-2">
              <mat-icon class="icon-sm text-blue-600">calendar_today</mat-icon>
              {{ reserva.fecha }}
            </div>
          </td>
        </ng-container>

        <!-- Hora Column -->
        <ng-container matColumnDef="hora">
          <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Horario</th>
          <td mat-cell *matCellDef="let reserva" class="text-gray-800 font-bold">
            <div class="flex items-center gap-3">
              <mat-icon class="icon-sm text-indigo-600">schedule</mat-icon>
              <div class="leading-tight">
                <div>{{ reserva.hora }} hs</div>
                <div class="text-xs font-normal text-gray-500">Sale {{ getHoraSalida(reserva) }} hs</div>
              </div>
            </div>
          </td>
        </ng-container>

        <!-- Cliente Column -->
        <ng-container matColumnDef="cliente">
          <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Cliente</th>
          <td mat-cell *matCellDef="let reserva" class="text-gray-800">
            <div class="flex items-center gap-2">
              <mat-icon class="icon-sm text-purple-600">person</mat-icon>
              {{ reserva.nombreCliente }} {{ reserva.apellidoCliente }}
            </div>
          </td>
        </ng-container>

        <!-- Personas Column -->
        <ng-container matColumnDef="personas">
          <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Personas</th>
          <td mat-cell *matCellDef="let reserva">
            <span class="badge-info">
              <mat-icon class="icon-sm">people</mat-icon>
              {{ reserva.cantidadPersonas }} {{ reserva.cantidadPersonas === 1 ? 'persona' : 'personas' }}
            </span>
          </td>
        </ng-container>

        <!-- Restaurante Column -->
        <ng-container matColumnDef="restaurante">
          <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Restaurante</th>
          <td mat-cell *matCellDef="let reserva" class="text-gray-600">
            <div class="flex items-center gap-1">
              <mat-icon class="icon-sm text-orange-600">restaurant</mat-icon>
              {{ restaurantNames[reserva.restauranteId] || 'Sin datos' }}
            </div>
          </td>
        </ng-container>

        <!-- Zona Column -->
        <ng-container matColumnDef="zona">
          <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Zona</th>
          <td mat-cell *matCellDef="let reserva" class="text-gray-600">
            <div class="flex items-center gap-1">
              <mat-icon class="icon-sm text-teal-600">map</mat-icon>
              {{ zonaNames[reserva.zonaId] || 'Sin zona' }}
            </div>
          </td>
        </ng-container>

        <!-- Mesa Column -->
        <ng-container matColumnDef="mesa">
          <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Mesa</th>
          <td mat-cell *matCellDef="let reserva" class="text-gray-600">
            <div class="flex items-center gap-2">
              <mat-icon class="icon-sm text-amber-600">chair</mat-icon>
              <ng-container *ngIf="reserva.mesaId && mesaMap[reserva.mesaId]; else mesaNoAsignada">
                <span class="font-semibold text-gray-800">Mesa {{ mesaMap[reserva.mesaId].numero }}</span>
                <span class="text-xs text-gray-500">
                  ({{ mesaMap[reserva.mesaId].capacidad }} {{ mesaMap[reserva.mesaId].capacidad === 1 ? 'persona' : 'personas' }})
                </span>
              </ng-container>
            </div>
          </td>
        </ng-container>
        <ng-template #mesaNoAsignada>
          <span class="text-gray-400 text-sm">Sin asignar</span>
        </ng-template>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Estado</th>
          <td mat-cell *matCellDef="let reserva">
            <span [ngClass]="getStatusClass(reserva.status)">
              <mat-icon class="icon-sm">{{ getStatusIcon(reserva.status) }}</mat-icon>
              {{ reserva.status }}
            </span>
          </td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef class="font-semibold text-gray-700">Acciones</th>
          <td mat-cell *matCellDef="let reserva">
            <div class="flex items-center gap-2">
              <button 
                mat-icon-button 
                *ngIf="reserva.status === 'CONFIRMADA'"
                (click)="completeReservation(reserva.id)"
                matTooltip="Completar reserva"
                class="action-btn action-btn-enable">
                <mat-icon>check_circle</mat-icon>
              </button>
              <button 
                mat-icon-button 
                *ngIf="reserva.status === 'CONFIRMADA'"
                (click)="cancelReservation(reserva.id)"
                matTooltip="Cancelar reserva"
                class="action-btn action-btn-disable">
                <mat-icon>cancel</mat-icon>
              </button>
              <span *ngIf="reserva.status !== 'CONFIRMADA'" class="text-gray-400 text-xs font-medium px-2 py-1 bg-gray-100 rounded">
                {{ reserva.status === 'COMPLETADA' ? 'âœ“ Completada' : 'âœ— Cancelada' }}
              </span>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>

    <!-- Empty state -->
    <div *ngIf="reservas.length === 0" class="empty-state">
      <mat-icon class="text-gray-300">event_busy</mat-icon>
      <p>No hay reservas registradas</p>
    </div>
  </div>
</div>
